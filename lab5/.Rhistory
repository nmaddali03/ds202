getwd()
source("C:/Users/neham/Desktop/DS202/ds202_lab5/lab5.R", echo=TRUE)
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), fill="black")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = 'lightgreen',
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE))+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = 'lightgreen', fill="black",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE))+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = 'lightgreen', color="black",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE))+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = 'lightgreen', fill="black",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), fill="lightgreen", color="black")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4),
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), fill="lightgreen", color="lightgreen")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4),
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), fill="lightgreen", color="lightgreen")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4),
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), color="lightgreen")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = "lightgreen",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), color="lightgreen")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), fill = "lightgreen",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), color="lightgreen")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = "lightgreen",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), color="black")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = "lightgreen",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), fill="black")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = "lightgreen",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE)) + geom_polygon(aes(group=group)) +
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4),
color='lightgreen', alpha=0.2, size=0.02) +
xlim(-130, -60) + ylim(20, 50) + coord_map()
#Question 6. Now plot a choropleth map of the number of deaths on a county level. Also explain
#what you find.
df <- readxl::read_xlsx("FRPP_GLC_-_United_StatesNov42021.xlsx")
states <- map_data('state')
counties <- map_data('county')
ggplot(states, aes(x=LONGITUD, y=LATITUDE)) + geom_polygon(aes(group=group)) +
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4),
color='lightgreen', alpha=0.2, size=0.02) +
xlim(-130, -60) + ylim(20, 50) + coord_map()
var <- c("STATE", "COUNTY", "FATALS")
fatals <- acc[var]
df$'State Code' <- as.numeric(df$`State Code`)
df$'City Code' <- as.numeric(df$`City Code`)
df$'County Code' <- as.numeric(df$`County Code`)
fatals <- fatals %>% group_by(STATE, COUNTY) %>%
summarize(FATALS = sum(FATALS))
fatals <- fatals %>% left_join(df, by=c('COUNTY' = 'County Code', 'STATE' =
'State Code'))
var2 <- c("State Name", "County Name", "FATALS")
fatals <- fatals[var2]
fatals <- unique(fatals)
fatals$`State Name` <- tolower(fatals$`State Name`)
fatals$`County Name` <- tolower(fatals$`County Name`)
fatals <- fatals %>% right_join(counties, by=c('County Name' = 'subregion',
'State Name' = 'region'))
ggplot(states, aes(x=LONGITUD, y=LATITUDE)) + geom_polygon(aes(group=group)) +
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4),
color='lightgreen', alpha=0.2, size=0.02) +
xlim(-130, -60) + ylim(20, 50) + coord_map()
ggplot(fatals, aes(x=LONGITUD, y=LATITUDE)) + geom_polygon(aes(group=group)) +
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4),
color='lightgreen', alpha=0.2, size=0.02) +
xlim(-130, -60) + ylim(20, 50) + coord_map()
deaths <- acc %>%
inner_join(fatal %>%
select(INJ_SEV, ST_CASE),
by=c("ST_CASE")) %>%
summarize(INJ_SEV,ST_CASE,LATITUDE, LONGITUD)
View(deaths)
states <- map_data('state')
#Question 6. Now plot a choropleth map of the number of deaths on a county level. Also explain
#what you find.
df <- readxl::read_xlsx("FRPP_GLC_-_United_StatesNov42021.xlsx")
states <- map_data('state')
View(state)
View(states)
deaths <- acc %>%
inner_join(fatal %>%
select(INJ_SEV, ST_CASE),
by=c("ST_CASE")) %>%
summarize(INJ_SEV,ST_CASE,LATITUDE, LONGITUD)
deaths <- acc %>%
inner_join(fatal %>%
select(INJ_SEV, ST_CASE),
by=c("ST_CASE")) %>%
summarize(INJ_SEV,ST_CASE,LATITUDE, LONGITUD)
test <- deaths %>%
inner_join(states %>%
select(long,lat,group),
by=c("long"="LONGITUD")) %>%
inner_join(states %>%
select(long,lat,group),
by=c("lat"="LATITUDE"))
test <- states %>%
inner_join(deaths %>%
select(long,lat,group),
by=c("long"="LONGITUD")) %>%
inner_join(deaths %>%
select(long,lat,group),
by=c("lat"="LATITUDE"))
test <- deaths %>%
inner_join(states %>%
select(long,lat,group),
by=c("LONGITUD"="long")) %>%
inner_join(states %>%
select(long,lat,group),
by=c("LATITUDE"="lat"))
View(test)
test <- deaths %>%
inner_join(states %>%
select(long,lat,group),
by=c("LONGITUD"="long")) %>%
inner_join(states %>%
select(long,lat,group),
by=c("LATITUDE"="lat")) %>%
summarize(INJ_SEV, ST_CASE, LATITUDE, LONGITUD,lat, group.x, long,group.y)
View(test)
View(fatal)
datTest <- fatal %>%
group_by(STATE, COUNTY) %>%
count
countymap <- map_data("county") %>%
mutate(
region = toupper(region),
subregion = toupper(subregion)
) %>%
left_join(states %>%
mutate(
`State Code` = as.integer(`State Code`), `County Code`
= as.integer(`County Code`)) %>% select(`State Name`, `State Code`,`County Name`,`'County Code`) %>% distinct, by = c(region='State Name', subregion = 'County Name')) %>%
left_join(datTest, by=c('State Code'='STATE','County Code' = 'COUNTY'))
View(states)
datTest <- fatal %>%
group_by(STATE, COUNTY) %>%
count
countymap <- map_data("county") %>%
mutate(
region = toupper(region),
subregion = toupper(subregion)
) %>%
left_join(fatals %>%
mutate(
`State Code` = as.integer(`State Code`), `County Code`
= as.integer(`County Code`)) %>% select(`State Name`, `State Code`,`County Name`,`'County Code`) %>% distinct, by = c(region='State Name', subregion = 'County Name')) %>%
left_join(datTest, by=c('State Code'='STATE','County Code' = 'COUNTY'))
#Question 6. Now plot a choropleth map of the number of deaths on a county level. Also explain
#what you find.
df <- readxl::read_xlsx("FRPP_GLC_-_United_StatesNov42021.xlsx")
states <- map_data('state')
counties <- map_data('county')
var <- c("STATE", "COUNTY", "FATALS")
fatals <- acc[var]
states <- df$'State Code' <- as.numeric(df$`State Code`)
datTest <- fatal %>%
group_by(STATE, COUNTY) %>%
count
countymap <- map_data("county") %>%
mutate(
region = toupper(region),
subregion = toupper(subregion)
) %>%
left_join(states %>%
mutate(
`State Code` = as.integer(`State Code`), `County Code`
= as.integer(`County Code`)) %>% select(`State Name`, `State Code`,`County Name`,`'County Code`) %>% distinct, by = c(region='State Name', subregion = 'County Name')) %>%
left_join(datTest, by=c('State Code'='STATE','County Code' = 'COUNTY'))
countymap %>% ggplot(aes(long,lat))+geom_polygon(aes(group=group,fill=n))+
scale_fill_gradient2(
low = 'white',
high = 'blue',
na.value='white'
)
datTest <- fatal %>%
group_by(STATE, COUNTY) %>%
count
countymap <- map_data("county") %>%
mutate(
region = toupper(region),
subregion = toupper(subregion)
) %>%
left_join(states %>%
mutate(
`State Code` = as.integer(`State Code`), `County Code`
= as.integer(`County Code`)) %>% select(`State Name`, `State Code`,`County Name`,`County Code`) %>% distinct, by = c(region='State Name', subregion = 'County Name')) %>%
left_join(datTest, by=c('State Code'='STATE','County Code' = 'COUNTY'))
states <- map_data('state')
#Question 6. Now plot a choropleth map of the number of deaths on a county level. Also explain
#what you find.
df <- readxl::read_xlsx("FRPP_GLC_-_United_StatesNov42021.xlsx")
states <- map_data('state')
counties <- map_data('county')
datTest <- fatal %>%
group_by(STATE, COUNTY) %>%
count
countymap <- map_data("county") %>%
mutate(
region = toupper(region),
subregion = toupper(subregion)
) %>%
left_join(states %>%
mutate(
`State Code` = as.integer(`State Code`), `County Code`
= as.integer(`County Code`)) %>% select(`State Name`, `State Code`,`County Name`,`County Code`) %>% distinct, by = c(region='State Name', subregion = 'County Name')) %>%
left_join(datTest, by=c('State Code'='STATE','County Code' = 'COUNTY'))
deaths <- acc %>%
inner_join(fatal %>%
select(INJ_SEV, ST_CASE),
by=c("ST_CASE")) %>%
summarize(INJ_SEV,ST_CASE,LATITUDE, LONGITUD)
ggplot(deaths, aes(x=LONGITUD, y=LATITUDE))+geom_polygon(aes(group=ST_CASE), fill="black")+
geom_point(aes(x=LONGITUD, y=LATITUDE), data=deaths %>% filter(INJ_SEV==4), color = "lightgreen",
alpha=0.2, size=0.02)+xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",
title="Number of Deaths in a County")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
Winter <- acc %>%
filter(MONTH < 5 | MONTH > 10)
Summer <- acc %>%
filter(MONTH > 5 & MONTH < 10)
var3 <- c("State Name", "State Code")
df2 <- df[var3]
df2 <- unique(df2)
winterFatal <- Winter %>%
group_by(STATE) %>%
summarize(FATALS = sum(FATALS))
summerFatal <- Summer %>%
group_by(STATE) %>%
summarize(FATALS = sum(FATALS))
summerFatal <- summerFatal %>% left_join(df2, by=c('STATE' = 'State Code'))
df <- readxl::read_xlsx("FRPP_GLC_-_United_StatesNov42021.xlsx")
states <- map_data('state')
counties <- map_data('county')
var <- c("STATE", "COUNTY", "FATALS")
fatals <- acc[var]
df$'State Code' <- as.numeric(df$`State Code`)
df$'City Code' <- as.numeric(df$`City Code`)
df$'County Code' <- as.numeric(df$`County Code`)
fatals <- fatals %>% group_by(STATE, COUNTY) %>%
summarize(FATALS = sum(FATALS))
Winter <- acc %>%
filter(MONTH < 5 | MONTH > 10)
Summer <- acc %>%
filter(MONTH > 5 & MONTH < 10)
var3 <- c("State Name", "State Code")
df2 <- df[var3]
df2 <- unique(df2)
winterFatal <- Winter %>%
group_by(STATE) %>%
summarize(FATALS = sum(FATALS))
summerFatal <- Summer %>%
group_by(STATE) %>%
summarize(FATALS = sum(FATALS))
summerFatal <- summerFatal %>% left_join(df2, by=c('STATE' = 'State Code'))
summerFatal$`State Name` <- tolower(summerFatal$`State Name`)
summerFatal <- summerFatal %>% right_join(states, by=c('State Name' = 'region'))
var2 <- c("STATE", "FATALS", "long", "lat", "group")
summerFatal <- summerFatal[var2]
ggplot(summerFatal, aes(x=long, y=lat, fill = FATALS)) +
geom_polygon(aes(group = group)) +
labs(title = "Car Accidents in the Summer by State")
winterFatal <- winterFatal %>% left_join(df2, by=c('STATE' = 'State Code'))
winterFatal$`State Name` <- tolower(winterFatal$`State Name`)
winterFatal <- winterFatal %>% right_join(states, by=c('State Name' = 'region'))
winterFatal <- winterFatal[var2]
ggplot(winterFatal, aes(x=long, y=lat, fill = FATALS)) +
geom_polygon(aes(group = group)) +
labs(title = "Car Accidents in the Winter by State")
deaths <- accident %>%
inner_join(fatality %>%
select(INJ_SEV, ST_CASE),
by=c("ST_CASE")) %>%
summarize(INJ_SEV, ST_CASE, LATITUDE, LONGITD, STATE)
deaths <- accident %>%
inner_join(fatal %>%
select(INJ_SEV, ST_CASE),
by=c("ST_CASE")) %>%
summarize(INJ_SEV, ST_CASE, LATITUDE, LONGITD, STATE)
deaths <- accident %>%
inner_join(fatal %>%
select(INJ_SEV, ST_CASE),
by=c("ST_CASE")) %>%
summarize(INJ_SEV, ST_CASE, LATITUDE, LONGITUD, STATE)
ggplot(states, aes(x=long, y=lat)) +
geom_polygon(aes(group=group)) + geom_point(aes(x=LONGITUD, y=LATITUDE),
data=deaths %>% filter(INJ_SEV == 4),
color = 'lightgreen',alpha=0.2,size=0.02)+
xlim(-130,-60)+ylim(20,50)+coord_map()+labs(x="Longitude",y="Latitude",title="Number of Deaths in a County")
