#Question 1: Reformat the offClean data frame into a tidy format using pivot_longer.
#The type of statistic (Receiving_REC for the number of receivings, Receiving_YDS for
#receiving yards, etc) is added as a new key column named stat.
dat1 <- offClean %>%
pivot_longer(Receiving_REC:Passing_INT, names_to = "stat", values_to = "score")
View(dat1)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
#offClean %>%
# group_by(Name) %>%
#summarize(score)
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
#Question 4: Did ISU have better offense against Oregon or Oklahoma? Answer this
#question by creating a scatterplot with the x- and y-axes being the receiving yards of
#the ISU players against each of these two opponents. A large number of receiving yards
#indicates good offense.
#Question 5: Separate the Hometown column into two columns, namely, the city and the
#state where the player comes from. Print the first few rows of these two columns.
#(Hint: look at the sep= argument of separate)
bioClean <- bioClean %>%
separate(Hometown,c('city', 'state'), sep = ',', convert = TRUE, remove = FALSE) %>%
mutate(City = city) %>%
mutate(State = state) %>%
summarize(Name, Position, HeightInches, Weight, Class, Hometown, City, State, Highschool)
#Question 6: How many players are there from each state?
#Question 7: How does the performance of quarterback Brock Purdy relate to the
#performance of the ISU team? Comment on both the defense and offense.
#Question 1: Reformat the offClean data frame into a tidy format using pivot_longer.
#The type of statistic (Receiving_REC for the number of receivings, Receiving_YDS for
#receiving yards, etc) is added as a new key column named stat.
offClean <- offClean %>%
pivot_longer(Receiving_REC:Passing_INT, names_to = "stat", values_to = "score")
View(offClean)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
offClean %>%
group_by(Name) %>%
summarize(score)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(score)
View(dat1)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
statsSum = (statSum == 1)
)
View(dat1)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
statsSum = (statSum == 1)
) %>%
select(-statsSum) %>%
View(dat1)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
statsSum = (statSum == 1)
) %>%
select(-statsSum)
View(dat1)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
once = (statSum == 1)
) %>%
select(-once)
View(dat1)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
once = (statSum == 1)
) %>%
select(-once)
dat1
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
) %>%
dat1
#Question 5: Separate the Hometown column into two columns, namely, the city and the
#state where the player comes from. Print the first few rows of these two columns.
#(Hint: look at the sep= argument of separate)
bioClean <- bioClean %>%
separate(Hometown,c('city', 'state'), sep = ',', convert = TRUE, remove = FALSE) %>%
mutate(City = city) %>%
mutate(State = state) %>%
summarize(Name, Position, HeightInches, Weight, Class, Hometown, City, State, Highschool)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n()
) %>%
dat1
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
once = (statSum == 1)
) %>%
select(-once)
dat1
#Question 6: How many players are there from each state?
dat3 <- bioClean %>%
group_by(State) %>%
summarize(
statePlayers = n(),
once = (stateSum == 1)
) %>%
select(-once)
#Question 6: How many players are there from each state?
dat3 <- bioClean %>%
group_by(State) %>%
summarize(
statePlayers = n(),
once = (statePlayers == 1)
) %>%
select(-once)
dat3
View(dat3)
View(bioClean)
View(offClean)
View(defClean)
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) + geom_point() + facet_grid(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) + geom_point() + facet_wrap(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) + geom_histogram() + facet_wrap(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) + geom_histogram(bins=30) + facet_wrap(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) + geom_histogram(position="dodge"bins=30) + facet_wrap(~stat)
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) + geom_histogram(position="dodge",bins=30) + facet_wrap(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) +
geom_histogram(position="dodge",bins=30) + facet_wrap(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) +
geom_bar() + facet_wrap(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) +
geom_bar() + facet_wrap(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
p <- ggplot(offClean, aes(x=Name, y=score)) +
geom_bar() + facet_wrap(~stat)
p
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
testing <- ggplot(offClean, aes(x=Name, y=score)) +
geom_bar() + facet_wrap(~stat)
testing
rlang::last_error()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
testing <- ggplot(offClean, aes(x=Name, y=score)) +
geom_bar() + facet_wrap(~stat)
testing
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
testing <- ggplot(offClean, aes(x=Name, y=score)) +
geom_bar() + facet_wrap(~stat)
testing
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
testing1 <- ggplot(offClean, aes(x=Name, y=Score)) + geom_point() + facet_wrap(~stat)
testing1
testing1
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
testing1 <- ggplot(offClean, aes(x=Name, y=score)) + geom_point() + facet_wrap(~stat)
testing1
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
testing1 <- ggplot(offClean, aes(x=Name, y=score)) + geom_histogram() + facet_wrap(~stat)
testing1
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
testing1 <- ggplot(offClean, aes(x=Name, y=score)) + geom_bar() + facet_wrap(~stat)
testing1
getwd()
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyverse)
defense <- read_excel('./cyclonesFootball2020.xlsx', sheet='Defensive')
offense <- read_excel('./cyclonesFootball2020.xlsx', sheet='Offensive')
bio <- read_excel('./cyclonesFootball2020.xlsx', sheet='Biography')
str(defense)
str(offense)
str(bio)
#Part 1: cleaning the data
#Question 1: The player names and opponent names should be factors.
defense %>%
factor('Name','Opponent_Opponent')
offense %>%
factor('Name', 'Oppenent_Opponent')
bio %>%
factor('Name')
#Question 2: All offensive and defensive statistics should be numerical. The Weight column
#in biogrpahy should also be numeric. (Optional: Read ?across and learn to mutate multiple
#columns simultaneously using the across function in dplyr)
defense <- defense %>%
mutate(across(Tackles_Solo:Pass_PB, as.numeric))
#View(defense)
offense <- offense %>%
mutate(
across(everything(), ~replace_na(.x,0))
)
bio <- bio %>%
mutate(across(Weight, as.numeric))
#View(bio)
#Question 3: The Height column in biography should be numeric. (Hint: Use a unit that
#works well)
bio <- bio %>%
separate(Height,c('feet', 'inches'), sep = '-', convert = TRUE, remove = FALSE) %>%
mutate(Height = 12*feet + inches) %>%
select(-feet) %>%
select(-inches) %>%
summarize(Name, Position, HeightInches = Height, Weight, Class, Hometown, Highschool)
#Question 4: Add a column to both defense and offense indicating whether it is the first or
#the second game versus an opponent. We had a single game versus each opponent except for
#Oklahoma, which we played against twice. (Hint: You can use group_by(), mutate(), and
#row_number())
defense <- defense %>%
group_by(Name, Opponent_Opponent) %>%
mutate(Game = row_number())
offense <- offense %>%
group_by(Name, Opponent_Opponent) %>%
mutate(Game = row_number())
defClean <- defense
offClean <- offense
bioClean <- bio
View(defClean)
View(offClean)
View(bioClean)
#Part 2: tidying and exploring
#Question 1: Reformat the offClean data frame into a tidy format using pivot_longer.
#The type of statistic (Receiving_REC for the number of receivings, Receiving_YDS for
#receiving yards, etc) is added as a new key column named stat.
offClean <- offClean %>%
pivot_longer(Receiving_REC:Passing_INT, names_to = "stat", values_to = "score")
View(offClean)
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
once = (statSum == 1)
) %>%
select(-once)
dat1
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat='identity', fill='forest green')+
facet_wrap(~stat)
#Question 4: Did ISU have better offense against Oregon or Oklahoma? Answer this
#question by creating a scatterplot with the x- and y-axes being the receiving yards of
#the ISU players against each of these two opponents. A large number of receiving yards
#indicates good offense.
#Question 5: Separate the Hometown column into two columns, namely, the city and the
#state where the player comes from. Print the first few rows of these two columns.
#(Hint: look at the sep= argument of separate)
bioClean <- bioClean %>%
separate(Hometown,c('city', 'state'), sep = ',', convert = TRUE, remove = FALSE) %>%
mutate(City = city) %>%
mutate(State = state) %>%
summarize(Name, Position, HeightInches, Weight, Class, Hometown, City, State, Highschool)
#Question 6: How many players are there from each state?
dat3 <- bioClean %>%
group_by(State) %>%
summarize(
statePlayers = n(),
once = (statePlayers == 1)
) %>%
select(-once)
View(dat3)
#Question 7: How does the performance of quarterback Brock Purdy relate to the
#performance of the ISU team? Comment on both the defense and offense.
#Question 4: Did ISU have better offense against Oregon or Oklahoma? Answer this
#question by creating a scatterplot with the x- and y-axes being the receiving yards of
#the ISU players against each of these two opponents. A large number of receiving yards
#indicates good offense.
datTest<-offClean[offClean$Opponent_Opponent%in%c('Oregon','Oklahoma'), ]
ggplot(datTest, aes(x=Opponent_Opponent, y=Receiving_YDS)) + geom_point()
#Question 4: Did ISU have better offense against Oregon or Oklahoma? Answer this
#question by creating a scatterplot with the x- and y-axes being the receiving yards of
#the ISU players against each of these two opponents. A large number of receiving yards
#indicates good offense.
datTest<-offClean[offClean$Opponent_Opponent%in%c('Oregon','Oklahoma'), ]
datTest1<-offClean[offClean$stat%in%c('Receiving_YDS'), ]
ggplot(datTest, aes(x=Opponent_Opponent, y=datTest1)) + geom_point()
ggplot(datTest, aes(x=datTest, y=datTest1)) + geom_point()
#Question 4: Did ISU have better offense against Oregon or Oklahoma? Answer this
#question by creating a scatterplot with the x- and y-axes being the receiving yards of
#the ISU players against each of these two opponents. A large number of receiving yards
#indicates good offense.
datTest<-offClean[offClean$Opponent_Opponent%in%c('Oregon','Oklahoma'), ]
datTest1<-offClean[offClean$stat%in%c('Receiving_YDS'), ]
ggplot(datTest, aes(x=datTest, y=datTest1)) + geom_point()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=score, y=Name)) + geom_bar(stat='identity', fill='forest green')+
facet_wrap(~stat)
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat='identity', fill='forest green')+
facet_wrap(~stat)
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat='identity', fill='forest green')+
facet_wrap(~stat) + coord_flip()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat='identity')+
facet_wrap(~stat) + coord_flip()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar()+
facet_wrap(~stat) + coord_flip()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar()+
facet_wrap(~stat) + coord_flip()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat = "stat")+
facet_wrap(~stat) + coord_flip()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat = 'identity')+
facet_wrap(~stat) + coord_flip()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat = 'identity')+
facet_wrap(~stat) + coord_flip()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat = 'identity')+ scale_x_discrete(guide = guide_axis(check.overlap = TRUE))+
facet_wrap(~stat) + coord_flip()
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat = 'identity')+
facet_wrap(~stat) + coord_flip()
ggplot(datTest, aes(x=datTest, y=datTest1)) + geom_point()
ggplot(datTest, aes(x=datTest1, y=score)) + geom_point()
ggplot(datTest, aes(x=stat, y=score)) + geom_point()
ggplot(offClean, aes(x=stat, y=score)) +
geom_point(data=subset(offClean,stat=="Receiving_YDS"),stat="identity")
ggplot(offClean, aes(x=stat, y=score)) +
geom_point(data=subset(offClean,stat=="Receiving_YDS"))
#Question 3: Show the distributions of the player-level offensive statistics. The
#distribution of each offensive statsitic should be shown in a separate facet. Explain
#the patterns you see.
ggplot(offClean, aes(x=Name, y=score)) + geom_bar(stat = 'identity')+
facet_wrap(~stat) + coord_flip()
dat4 <- offClean %>%
pivot_wider(names_from = stat, values_from = Receiving_YDS)
offense <- read_excel('./cyclonesFootball2020.xlsx', sheet='Offensive')
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyverse)
offense <- read_excel('./cyclonesFootball2020.xlsx', sheet='Offensive')
str(offense)
offense %>%
factor('Name', 'Oppenent_Opponent')
offense <- offense %>%
mutate(
across(everything(), ~replace_na(.x,0))
)
offense <- offense %>%
group_by(Name, Opponent_Opponent) %>%
mutate(Game = row_number())
offClean <- offense
View(offClean)
#Question 1: Reformat the offClean data frame into a tidy format using pivot_longer.
#The type of statistic (Receiving_REC for the number of receivings, Receiving_YDS for
#receiving yards, etc) is added as a new key column named stat.
offClean <- offClean %>%
pivot_longer(Receiving_REC:Passing_INT, names_to = "stat", values_to = "score")
View(offClean)
datTest <- offClean %>%
group_by(Name, stat) %>%
summarize(stat_sum=sum(score))
datTest
datTest <- offClean %>%
group_by(Name, stat) %>%
summarize(stat_sum=sum(score))
stat_sam <- 0
datTest <- offClean %>%
group_by(Name, stat) %>%
summarize(stat_sum=sum(score))
datTest
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
once = (statSum == 1)
) %>%
select(-once)
dat1
stat_sum <- 0
datTest <- offClean %>%
group_by(Name, stat) %>%
summarize(stat_sum=sum(score))
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name) %>%
summarize(
statSum = n(),
once = (statSum == 1)
) %>%
select(-once)
dat1
View(dat1)
ggplot(dat1, aes(x=Name, weight=statSum, fill=Name))+geom_bar()+
facet_wrap(~Stat_type)+coord_flip()
ggplot(dat1, aes(x=Name, weight=statSum, fill=Name))+geom_bar()+
facet_wrap(~stat)+coord_flip()
#Question 2: Obtain the player-level offensive statistics. Namely, for each player and
#each type of statistics, obtain the sum of the statistics in all games.
dat1 <- offClean %>%
group_by(Name, stat) %>%
summarize(
statSum = n(),
once = (statSum == 1)
) %>%
select(-once)
dat1
View(dat1)
ggplot(dat1, aes(x=Name, weight=statSum, fill=Name))+geom_bar()+
facet_wrap(~stat)+coord_flip()
